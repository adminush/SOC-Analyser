@echo off
set Hostname=%1
set Option=%2
powershell -Command "& {New-Item -Path '.\Result\%Hostname%\' -Name "Logs" -ItemType 'directory'}"
if %Option%==all (powershell -Command "& {Copy-Item \\%Hostname%\C$\WINDOWS\System32\winevt\Logs\Application.evtx -Destination .\Result\%Hostname%\Logs\; Rename-Item -Path ".\Result\%Hostname%\Logs\Application.evtx" -NewName "%Hostname%-Application.evtx"; Copy-Item \\%Hostname%\C$\WINDOWS\System32\winevt\Logs\Security.evtx -Destination .\Result\%Hostname%\Logs\; Rename-Item -Path ".\Result\%Hostname%\Logs\Security.evtx" -NewName "%Hostname%-Security.evtx"; Copy-Item \\%Hostname%\C$\WINDOWS\System32\winevt\Logs\Microsoft-Windows-Sysmon%%4Operational.evtx -Destination .\Result\%Hostname%\Logs\; Rename-Item -Path ".\Result\%Hostname%\Logs\Microsoft-Windows-Sysmon%%4Operational.evtx" -NewName "%Hostname%-Sysmon.evtx"; Copy-Item \\%Hostname%\C$\WINDOWS\System32\winevt\Logs\Microsoft-Windows-PowerShell%%4Operational.evtx -Destination .\Result\%Hostname%\Logs\; Rename-Item -Path ".\Result\%Hostname%\Logs\Microsoft-Windows-PowerShell%%4Operational.evtx" -NewName "%Hostname%-PowerShell.evtx"; Copy-Item \\%Hostname%\C$\WINDOWS\System32\winevt\Logs\Microsoft-Windows-TerminalServices-RemoteConnectionManager%%4Operational.evtx -Destination .\Result\%Hostname%\Logs\; Rename-Item -Path ".\Result\%Hostname%\Logs\Microsoft-Windows-TerminalServices-RemoteConnectionManager%%4Operational.evtx" -NewName "%Hostname%-TerminalServices-RemoteConnectionManager.evtx"; Copy-Item \\%Hostname%\C$\WINDOWS\System32\winevt\Logs\Microsoft-Windows-TerminalServices-LocalSessionManager%%4Operational.evtx -Destination .\Result\%Hostname%\Logs\; Rename-Item -Path ".\Result\%Hostname%\Logs\Microsoft-Windows-TerminalServices-LocalSessionManager%%4Operational.evtx" -NewName "%Hostname%-TerminalServices-LocalSessionManager.evtx"; Copy-Item \\%Hostname%\C$\WINDOWS\System32\winevt\Logs\Microsoft-Windows-WinRM%%4Operational.evtx -Destination .\Result\%Hostname%\Logs\; Rename-Item -Path ".\Result\%Hostname%\Logs\Microsoft-Windows-WinRM%%4Operational.evtx" -NewName "%Hostname%-WinRM.evtx"; Copy-Item \\%Hostname%\C$\WINDOWS\System32\winevt\Logs\Microsoft-Windows-TerminalServices-Gateway%%4Operational.evtx -Destination .\Result\%Hostname%\Logs\; Rename-Item -Path ".\Result\%Hostname%\Logs\Microsoft-Windows-TerminalServices-Gateway%%4Operational.evtx" -NewName "%Hostname%-TerminalServices-Gateway.evtx"; Copy-Item \\%Hostname%\C$\WINDOWS\System32\winevt\Logs\Microsoft-Windows-Shell-Core%%4Operational.evtx -Destination .\Result\%Hostname%\Logs\; Rename-Item -Path ".\Result\%Hostname%\Logs\Microsoft-Windows-Shell-Core%%4Operational.evtx" -NewName "%Hostname%-Shell-Core.evtx"; Copy-Item \\%Hostname%\C$\WINDOWS\System32\winevt\Logs\Microsoft-Windows-Bits-Client%%4Operational.evtx -Destination .\Result\%Hostname%\Logs\; Rename-Item -Path ".\Result\%Hostname%\Logs\Microsoft-Windows-Bits-Client%%4Operational.evtx" -NewName "%Hostname%-Bits-Client.evtx"; Copy-Item \\%Hostname%\C$\WINDOWS\System32\winevt\Logs\Microsoft-WindowsTaskScheduler%%4Operational -Destination .\Result\%Hostname%\Logs\; Rename-Item -Path ".\Result\%Hostname%\Logs\Microsoft-WindowsTaskScheduler%%4Operational" -NewName "%Hostname%-WindowsTaskScheduler.evtx"}")
echo %Option%
if %Option%==main (powershell -Command "& {Copy-Item \\%Hostname%\C$\WINDOWS\System32\winevt\Logs\Application.evtx -Destination .\Result\%Hostname%\Logs\; Rename-Item -Path ".\Result\%Hostname%\Logs\Application.evtx" -NewName "%Hostname%-Application.evtx"; Copy-Item \\%Hostname%\C$\WINDOWS\System32\winevt\Logs\Security.evtx -Destination .\Result\%Hostname%\Logs\; Rename-Item -Path ".\Result\%Hostname%\Logs\Security.evtx" -NewName "%Hostname%-Security.evtx"; Copy-Item \\%Hostname%\C$\WINDOWS\System32\winevt\Logs\Microsoft-Windows-Sysmon%%4Operational.evtx -Destination .\Result\%Hostname%\Logs\; Rename-Item -Path ".\Result\%Hostname%\Logs\Microsoft-Windows-Sysmon%%4Operational.evtx" -NewName "%Hostname%-Sysmon.evtx"}")